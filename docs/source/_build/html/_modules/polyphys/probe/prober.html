
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>polyphys.probe.prober &#8212; polyphys 0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/alabaster.css" />
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for polyphys.probe.prober</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Type</span>
<span class="kn">import</span> <span class="nn">MDAnalysis</span> <span class="k">as</span> <span class="nn">mda</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">polyphys.manage.parser</span> <span class="kn">import</span> <span class="n">SumRule</span>
<span class="kn">from</span> <span class="nn">polyphys.manage.organizer</span> <span class="kn">import</span> <span class="n">invalid_keyword</span>


<span class="k">def</span> <span class="nf">log_datasets</span><span class="p">(</span>
    <span class="n">log</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">geometry</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;biaxial&#39;</span><span class="p">,</span>
    <span class="n">group</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;bug&#39;</span><span class="p">,</span>
    <span class="n">lineage</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;segment&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    generates the &#39;details&#39; and &#39;runtime&#39; &#39;csv&#39; files with a pre-defined list \</span>
<span class="sd">    of header names.</span>

<span class="sd">    The &#39;details&#39; file contains the information about  input parameters \</span>
<span class="sd">    and settings in a set of LAMMPS simulations.</span>

<span class="sd">    The &#39;runtime&#39; file contains information about the runtimes of a set of \</span>
<span class="sd">     LAMMPS simulations.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    log: str</span>
<span class="sd">        The name of the LAMMPS log file.</span>
<span class="sd">    geometry : {&#39;biaxial&#39;, &#39;slit&#39;, &#39;box&#39;}, default &#39;biaxial&#39;</span>
<span class="sd">        Shape of the simulation box.</span>
<span class="sd">    group: {&#39;bug&#39;, &#39;all&#39;}, default &#39;bug&#39;</span>
<span class="sd">        Type of the particle group.</span>
<span class="sd">    lineage: {&#39;segment&#39;, &#39;whole&#39;}, default &#39;segment&#39;</span>
<span class="sd">        Type of the input file.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    details_out: str</span>
<span class="sd">        The name of the details dataset.</span>
<span class="sd">    runtime_out: str</span>
<span class="sd">        The name of the runtime dataset.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">sim_info</span> <span class="o">=</span> <span class="n">SumRule</span><span class="p">(</span>
        <span class="n">log</span><span class="p">,</span>
        <span class="n">geometry</span><span class="o">=</span><span class="n">geometry</span><span class="p">,</span>
        <span class="n">group</span><span class="o">=</span><span class="n">group</span><span class="p">,</span>
        <span class="n">lineage</span><span class="o">=</span><span class="n">lineage</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">details_out</span> <span class="o">=</span> <span class="n">sim_info</span><span class="o">.</span><span class="n">ensemble</span> <span class="o">+</span> <span class="s1">&#39;-log_details.csv&#39;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">details_out</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">detailsfile</span><span class="p">:</span>
        <span class="c1"># write simulation information</span>
        <span class="k">for</span> <span class="n">lineage_name</span> <span class="ow">in</span> <span class="n">sim_info</span><span class="o">.</span><span class="n">genealogy</span><span class="p">:</span>
            <span class="n">detailsfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">lineage_name</span><span class="si">}</span><span class="s2">,&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">attr_name</span> <span class="ow">in</span> <span class="n">sim_info</span><span class="o">.</span><span class="n">attributes</span><span class="p">:</span>
            <span class="n">detailsfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">attr_name</span><span class="si">}</span><span class="s2">,&quot;</span><span class="p">)</span>
        <span class="c1"># neig_modify delay NUM every NUM check YES/NO:</span>
        <span class="n">detailsfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;,ens,run_seg,&#39;</span>
                          <span class="s1">&#39;rskin,delay,every,</span><span class="se">\</span>
<span class="s1">            check,&#39;</span><span class="p">)</span>
        <span class="n">detailsfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;total_time_s,cores,timestep,</span><span class="se">\</span>
<span class="s1">            atoms,ts_per_sec,&#39;</span><span class="p">)</span>
        <span class="c1"># Section columns: min time, avg time, max time, %varavg, %total&quot;</span>
        <span class="c1"># Section rows: Pair, Bond, Neigh, Comm, Output, Modify, Other</span>
        <span class="n">detailsfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;pair_avg_s,pair_pct,bond_avg_s,bond_pct,neigh_avg_s,</span><span class="se">\</span>
<span class="s1">            neigh_pct,comm_avg_s,&#39;</span><span class="p">)</span>
        <span class="n">detailsfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;comm_pct,output_avg_s,output_pct,modify_avg_s,</span><span class="se">\</span>
<span class="s1">            modify_pct,other_avg_s,other_pct,dangerous</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">runtime_out</span> <span class="o">=</span> <span class="n">sim_info</span><span class="o">.</span><span class="n">ensemble</span> <span class="o">+</span> <span class="s2">&quot;-log_runtime.csv&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">runtime_out</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">runfile</span><span class="p">:</span>
        <span class="n">runfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;groupname,filename,n_cores,n_atoms,wall_time</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">details_out</span><span class="p">,</span> <span class="n">runtime_out</span>


<span class="c1"># noinspection DuplicatedCode</span>
<span class="k">def</span> <span class="nf">log_parser</span><span class="p">(</span>
    <span class="n">logs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
    <span class="n">details_out</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">runtime_out</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">geometry</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;biaxial&#39;</span><span class="p">,</span>
    <span class="n">group</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;bug&#39;</span><span class="p">,</span>
    <span class="n">lineage</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;segment&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    parses a LAMMPS `logs`, gather the information about simulations from \</span>
<span class="sd">    their `logs`, and write down simulation details to `details_out` csv \</span>
<span class="sd">    files and runtime information to `runtime_out` csv file.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    logs: list of str</span>
<span class="sd">        The list of LAMMPS log files where each element of list is a tuple \</span>
<span class="sd">        file with one element; a string that is the filepath for the log.</span>
<span class="sd">    details_out: str</span>
<span class="sd">        The name of the &#39;details&#39; file in which the simulation details is \</span>
<span class="sd">        written.</span>
<span class="sd">    runtime_out: str</span>
<span class="sd">        The name of the &#39;runtime&#39; file in which the runtime information is \</span>
<span class="sd">        written.</span>
<span class="sd">    geometry : {&#39;biaxial&#39;, &#39;slit&#39;, &#39;box&#39;}, default &#39;biaxial&#39;</span>
<span class="sd">        Shape of the simulation box.</span>
<span class="sd">    group: {&#39;bug&#39;, &#39;all&#39;}, default &#39;bug&#39;</span>
<span class="sd">        Type of the particle group.</span>
<span class="sd">    lineage: {&#39;segment&#39;, &#39;whole&#39;}, default &#39;segment&#39;</span>
<span class="sd">        Type of the input file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">log</span> <span class="ow">in</span> <span class="n">logs</span><span class="p">:</span>
        <span class="n">sim_info</span> <span class="o">=</span> <span class="n">SumRule</span><span class="p">(</span>
            <span class="n">log</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">geometry</span><span class="o">=</span><span class="n">geometry</span><span class="p">,</span>
            <span class="n">group</span><span class="o">=</span><span class="n">group</span><span class="p">,</span>
            <span class="n">lineage</span><span class="o">=</span><span class="n">lineage</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">sim_info</span><span class="o">.</span><span class="n">filename</span>
        <span class="n">ens</span> <span class="o">=</span> <span class="n">sim_info</span><span class="o">.</span><span class="n">ensemble_id</span>
        <span class="n">groupname</span> <span class="o">=</span> <span class="n">sim_info</span><span class="o">.</span><span class="n">lineage_name</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">details_out</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">detailsfile</span><span class="p">:</span>
            <span class="c1"># write simulation details</span>
            <span class="k">for</span> <span class="n">lineage_name</span> <span class="ow">in</span> <span class="n">sim_info</span><span class="o">.</span><span class="n">genealogy</span><span class="p">:</span>
                <span class="n">attr_value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">sim_info</span><span class="p">,</span> <span class="n">lineage_name</span><span class="p">)</span>
                <span class="n">detailsfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">attr_value</span><span class="si">}</span><span class="s2">,&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">attr_name</span> <span class="ow">in</span> <span class="n">sim_info</span><span class="o">.</span><span class="n">attributes</span><span class="p">:</span>
                <span class="n">attr_value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">sim_info</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">)</span>
                <span class="n">detailsfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">attr_value</span><span class="si">}</span><span class="s2">,&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">log</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">logfile</span><span class="p">,</span>\
            <span class="nb">open</span><span class="p">(</span><span class="n">details_out</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">detailsfile</span><span class="p">,</span>\
                <span class="nb">open</span><span class="p">(</span><span class="n">runtime_out</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">runfile</span><span class="p">:</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">logfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
            <span class="c1"># neigh_modify delay every check page one</span>
            <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">while</span> <span class="n">line</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;neighbor&#39;</span><span class="p">):</span>
                    <span class="n">words</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                    <span class="n">rskin</span> <span class="o">=</span> <span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>  <span class="c1"># rskin</span>
                <span class="c1"># neigh_modify delay every check page one</span>
                <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;neigh_modify&#39;</span><span class="p">):</span>
                    <span class="n">words</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                    <span class="c1"># picking the NUMs and Yes/No from neigh_modify</span>
                    <span class="n">delay</span> <span class="o">=</span> <span class="n">words</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                    <span class="n">every</span> <span class="o">=</span> <span class="n">words</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                    <span class="n">check</span> <span class="o">=</span> <span class="n">words</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;Loop time&#39;</span><span class="p">):</span>
                    <span class="n">detailsfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">))</span>  <span class="c1"># total time</span>
                    <span class="n">detailsfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
                    <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="c1"># neighbor and neigh_modify occurs\</span>
                    <span class="c1"># one time but other occurs 15 times.</span>
                    <span class="n">detailsfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">rskin</span><span class="p">)</span>  <span class="c1"># rskin</span>
                    <span class="n">detailsfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
                    <span class="n">detailsfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">delay</span><span class="p">)</span>  <span class="c1"># delay</span>
                    <span class="n">detailsfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
                    <span class="n">detailsfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">every</span><span class="p">)</span>  <span class="c1"># every</span>
                    <span class="n">detailsfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
                    <span class="n">detailsfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">check</span><span class="p">)</span>  <span class="c1"># check</span>
                    <span class="n">detailsfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
                    <span class="n">words</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                    <span class="n">detailsfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>  <span class="c1"># total time</span>
                    <span class="n">detailsfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
                    <span class="n">n_cores</span> <span class="o">=</span> <span class="n">words</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                    <span class="n">detailsfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">n_cores</span><span class="p">)</span>  <span class="c1"># # of cores</span>
                    <span class="n">detailsfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
                    <span class="n">detailsfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>  <span class="c1"># total timesteps</span>
                    <span class="n">detailsfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
                    <span class="n">n_atoms</span> <span class="o">=</span> <span class="n">words</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                    <span class="n">detailsfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">n_atoms</span><span class="p">)</span>  <span class="c1"># total atoms</span>
                    <span class="n">detailsfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;Performance:&#39;</span><span class="p">):</span>
                    <span class="n">words</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                    <span class="n">detailsfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>  <span class="c1"># timesteps per second</span>
                    <span class="n">detailsfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;Section&#39;</span><span class="p">):</span>
                    <span class="n">_</span> <span class="o">=</span> <span class="n">logfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>  \
                            <span class="c1"># Section rows: Pair, Bond, Neigh, Comm, Output,\</span>
                        <span class="c1"># Modify, Other</span>
                        <span class="c1"># Section columns: min time, avg time, max time,\</span>
                        <span class="c1"># %varavg, %total&quot;</span>
                        <span class="n">line</span> <span class="o">=</span> <span class="n">logfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
                        <span class="n">sect_min</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                        <span class="n">detailsfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">sect_min</span><span class="p">)</span>
                        <span class="n">detailsfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>

                        <span class="n">sect_pct</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># Pair pct of total time</span>
                        <span class="n">detailsfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">sect_pct</span><span class="p">)</span>
                        <span class="n">detailsfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="n">logfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
                    <span class="n">sect_min</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                    <span class="n">detailsfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">sect_min</span><span class="p">)</span>
                    <span class="n">detailsfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
                    <span class="n">sect_pct</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># Pair pct of total time</span>
                    <span class="n">detailsfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">sect_pct</span><span class="p">)</span>
                    <span class="n">detailsfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;Dangerous&#39;</span><span class="p">):</span>
                    <span class="n">words</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                    <span class="n">detailsfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])))</span>  \
                        <span class="c1"># # number of dangerous builds</span>
                    <span class="n">detailsfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="c1"># runtime files</span>
                <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;Total wall time&#39;</span><span class="p">):</span>
                    <span class="n">runfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">groupname</span><span class="p">)</span>
                    <span class="n">runfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
                    <span class="n">runfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
                    <span class="n">runfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
                    <span class="n">runfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">n_cores</span><span class="p">)</span>
                    <span class="n">runfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
                    <span class="n">runfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">n_atoms</span><span class="p">)</span>
                    <span class="n">runfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
                    <span class="n">words</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                    <span class="n">runfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>  <span class="c1"># total wall time</span>
                    <span class="n">runfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">line</span> <span class="o">=</span> <span class="n">logfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">stamps_report_with_measures</span><span class="p">(</span>
    <span class="n">report_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">sim_info</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">SumRule</span><span class="p">],</span>
    <span class="n">n_frames</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">measures</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    writes a summary of stamps (properties and attributes) of a simulation \</span>
<span class="sd">    to file.</span>

<span class="sd">    `stamps_report` generates a dataset called `report_name` of the \</span>
<span class="sd">    values of some attributes of `sim_info`, the number of frames \</span>
<span class="sd">    `n_frames`, all the key and value pairs in all the given dictionaries \</span>
<span class="sd">    `measures`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    report_name: str</span>
<span class="sd">        Name of the report.</span>
<span class="sd">    sim_info: SumRule object</span>
<span class="sd">        A SumRule object that contains information about the name, parents, \</span>
<span class="sd">        and physical attributes of a simulation.</span>
<span class="sd">    n_frames: int</span>
<span class="sd">        Number of frames/snapshots/configurations in a simulation.</span>
<span class="sd">    *measures: dict</span>
<span class="sd">        A dictionary of measures where a key and value pair is the name and \</span>
<span class="sd">        value of a physical property.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">report_name</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">report</span><span class="p">:</span>
        <span class="c1"># write header</span>
        <span class="k">for</span> <span class="n">lineage_name</span> <span class="ow">in</span> <span class="n">sim_info</span><span class="o">.</span><span class="n">genealogy</span><span class="p">:</span>
            <span class="n">report</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">lineage_name</span><span class="si">}</span><span class="s2">,&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">attr_name</span> <span class="ow">in</span> <span class="n">sim_info</span><span class="o">.</span><span class="n">attributes</span><span class="p">:</span>
            <span class="n">report</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">attr_name</span><span class="si">}</span><span class="s2">,&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">measure_name</span> <span class="ow">in</span> <span class="n">measures</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>  <span class="c1"># each measure is a dict</span>
            <span class="n">report</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">measure_name</span><span class="si">}</span><span class="s2">,&quot;</span><span class="p">)</span>
        <span class="n">report</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;n_frames</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="c1"># write values</span>
        <span class="k">for</span> <span class="n">lineage_name</span> <span class="ow">in</span> <span class="n">sim_info</span><span class="o">.</span><span class="n">genealogy</span><span class="p">:</span>
            <span class="n">attr_value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">sim_info</span><span class="p">,</span> <span class="n">lineage_name</span><span class="p">)</span>
            <span class="n">report</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">attr_value</span><span class="si">}</span><span class="s2">,&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">attr_name</span> <span class="ow">in</span> <span class="n">sim_info</span><span class="o">.</span><span class="n">attributes</span><span class="p">:</span>
            <span class="n">attr_value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">sim_info</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">)</span>
            <span class="n">report</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">attr_value</span><span class="si">}</span><span class="s2">,&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">measure_value</span> <span class="ow">in</span> <span class="n">measures</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">report</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">measure_value</span><span class="si">}</span><span class="s2">,&quot;</span><span class="p">)</span>
        <span class="n">report</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">n_frames</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">stamps_report</span><span class="p">(</span><span class="n">report_name</span><span class="p">,</span> <span class="n">sim_info</span><span class="p">,</span> <span class="n">n_frames</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    writes a summary of stamps (properties and attributes) of a simulation \</span>
<span class="sd">    to file.</span>

<span class="sd">    `stamps_report` generates a dataset called `report_name` of the \</span>
<span class="sd">    values of some attributes of `sim_info`, the number of frames \</span>
<span class="sd">    `n_frames`, all the key and value pairs in all the given dictionaries \</span>
<span class="sd">    `measures`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    report_name: str</span>
<span class="sd">        Name of the report.</span>
<span class="sd">    sim_info: SumRule object</span>
<span class="sd">        A SumRule object that contains information about the name, parents, \</span>
<span class="sd">        and physical attributes of a simulation.</span>
<span class="sd">    n_frames: int</span>
<span class="sd">        Number of frames/snapshots/configurations in a simulation.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">report_name</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">report</span><span class="p">:</span>
        <span class="c1"># write header</span>
        <span class="k">for</span> <span class="n">lineage_name</span> <span class="ow">in</span> <span class="n">sim_info</span><span class="o">.</span><span class="n">genealogy</span><span class="p">:</span>
            <span class="n">report</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">lineage_name</span><span class="si">}</span><span class="s2">,&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">attr_name</span> <span class="ow">in</span> <span class="n">sim_info</span><span class="o">.</span><span class="n">attributes</span><span class="p">:</span>
            <span class="n">report</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">attr_name</span><span class="si">}</span><span class="s2">,&quot;</span><span class="p">)</span>
        <span class="n">report</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;n_frames</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="c1"># write values</span>
        <span class="k">for</span> <span class="n">lineage_name</span> <span class="ow">in</span> <span class="n">sim_info</span><span class="o">.</span><span class="n">genealogy</span><span class="p">:</span>
            <span class="n">attr_value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">sim_info</span><span class="p">,</span> <span class="n">lineage_name</span><span class="p">)</span>
            <span class="n">report</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">attr_value</span><span class="si">}</span><span class="s2">,&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">attr_name</span> <span class="ow">in</span> <span class="n">sim_info</span><span class="o">.</span><span class="n">attributes</span><span class="p">:</span>
            <span class="n">attr_value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">sim_info</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">)</span>
            <span class="n">report</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">attr_value</span><span class="si">}</span><span class="s2">,&quot;</span><span class="p">)</span>
        <span class="n">report</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">n_frames</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">simple_stats</span><span class="p">(</span><span class="n">property_name</span><span class="p">,</span> <span class="n">array</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    measures the mean, standard deviation, variance, and standard error \</span>
<span class="sd">    of the mean (sem) for an array.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    property_name : str</span>
<span class="sd">        Name of physical property.</span>
<span class="sd">    array: numpy array of float</span>
<span class="sd">        Values of `property_name`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    stats: dict</span>
<span class="sd">        an dict of mean, std, var, and sem of `property_name`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Unbiased std, var, and sem.</span>
    <span class="n">stat</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">property_name</span> <span class="o">+</span> <span class="s1">&#39;_mean&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">array</span><span class="p">),</span>
        <span class="n">property_name</span> <span class="o">+</span> <span class="s1">&#39;_var&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
        <span class="n">property_name</span> <span class="o">+</span> <span class="s1">&#39;_sem&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">array</span><span class="p">))</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">stat</span>


<span class="k">def</span> <span class="nf">end_to_end</span><span class="p">(</span><span class="n">positions</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    measures the end-to-end distance of a linear polymer, in the frame of\</span>
<span class="sd">    reference located at the polymer&#39;s center of geometry.</span>

<span class="sd">    `positions` is sorted by atom id, so the end-to-end distance is simply \</span>
<span class="sd">    the difference between last and first items in `positions`/</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    positions : numpy array of float</span>
<span class="sd">        Positions (a n_atoms*n_dim  array) of the N atoms within an atom \</span>
<span class="sd">        group in a frame or snapshot or time step. `positions` is sorted \</span>
<span class="sd">        by atom number form 1 to N.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    edn_to_end: numpy array of float</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># calculation in the center of geometry of the atom group.</span>
    <span class="n">positions</span> <span class="o">=</span> <span class="n">positions</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">positions</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">positions</span> <span class="o">=</span> <span class="n">positions</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">positions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">positions</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">max_distance</span><span class="p">(</span><span class="n">positions</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    measures the maximum distance in each of the three Cartesian direction, \</span>
<span class="sd">    in the frame of reference located at the polymer&#39;s center of geometry.</span>

<span class="sd">    The maximum distance is computed by subtracting the max and min of all \</span>
<span class="sd">    the particle in an atom group in a given frame or snapshot or time step.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    positions: numpy array of dtype float</span>
<span class="sd">        Positions (a n_atoms*n_dim  array) of the N atoms within an atom \</span>
<span class="sd">        group in a frame or snapshot or time step. `positions` is sorted \</span>
<span class="sd">        by atom number form 1 to N.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    [xmax, ymax, zmax]: numpy array of  float</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># calculation in the center of geometry of the atom group.</span>
    <span class="n">positions</span> <span class="o">=</span> <span class="n">positions</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">positions</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">xmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">positions</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">amin</span><span class="p">(</span><span class="n">positions</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]))</span>
    <span class="n">ymax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">positions</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">amin</span><span class="p">(</span><span class="n">positions</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]))</span>
    <span class="n">zmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">positions</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">])</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">amin</span><span class="p">(</span><span class="n">positions</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]))</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">xmax</span><span class="p">,</span> <span class="n">ymax</span><span class="p">,</span> <span class="n">zmax</span><span class="p">])</span>


<span class="k">def</span> <span class="nf">fsd</span><span class="p">(</span>
    <span class="n">positions</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">axis</span><span class="o">=</span><span class="mi">2</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    calculates the average size/diameter of a polymer confined in a \</span>
<span class="sd">    cylindrical geometry based on the farthermost distance concept.</span>

<span class="sd">    fsd stands for Feret&#39;s statistical diameter: other names are the mean \</span>
<span class="sd">    span dimension, the farthermost distance, or the mean caliper diameter.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    positions: numpy array of  float</span>
<span class="sd">        Positions (a n_atoms*n_dim  array) of the N atoms within an atom \</span>
<span class="sd">        group in a frame or snapshot or time step. `positions` is sorted \</span>
<span class="sd">        by atom number form 1 to N.</span>
<span class="sd">    axis: int or tuple of int, default 2</span>
<span class="sd">        The index of the axis of the cylinder; by default it is the z axis.\</span>
<span class="sd">        It can be any integer in the range of the spatial dimension of the \</span>
<span class="sd">        system.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fsd: numpy array of  float</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    &quot;A Theoretical Study of the Separation Principle in Size Exclusion \</span>
<span class="sd">    Chromatography&quot;, Wang Y Teraoka</span>
<span class="sd">    I Hansen FY Peters GH Ole H. Macromolecules 2010, 43, 3, 1651-1659</span>
<span class="sd">    https://doi.org/10.1021/ma902377g</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># calculation in the center of geometry of the atom group:</span>
    <span class="n">positions</span> <span class="o">=</span> <span class="n">positions</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">positions</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">positions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ptp</span><span class="p">(</span><span class="n">positions</span><span class="p">[:,</span> <span class="n">axis</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">positions</span>


<span class="k">def</span> <span class="nf">bin_create</span><span class="p">(</span><span class="n">sim_name</span><span class="p">,</span> <span class="n">edge_name</span><span class="p">,</span> <span class="n">bin_size</span><span class="p">,</span> <span class="n">lmin</span><span class="p">,</span> <span class="n">lmax</span><span class="p">,</span> <span class="n">save_to</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    generates arrays of bins and histograms</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    sim_name: str</span>
<span class="sd">        Name of the simulation.</span>
<span class="sd">    edge_name: str</span>
<span class="sd">        Name of the variable for which the histogram is computed.</span>
<span class="sd">    bin_size : float</span>
<span class="sd">        Size of each bin.</span>
<span class="sd">    lmin : float</span>
<span class="sd">        Lower bound of the system in the direction of interest.</span>
<span class="sd">    lmax : float</span>
<span class="sd">        Upper bound of the system in the direction of interest.</span>
<span class="sd">    save_to : str</span>
<span class="sd">        Whether save outputs to memory as csv files or not.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    bin_edges : numpy array of float</span>
<span class="sd">        The edges to pass into a histogram. Save `bin_edges` to file if \</span>
<span class="sd">        `save_to` is not None.</span>
<span class="sd">    hist: array of int</span>
<span class="sd">        An empty histogram</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">bin_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">lmin</span><span class="p">,</span> <span class="n">lmax</span> <span class="o">+</span> <span class="n">bin_size</span><span class="p">,</span> <span class="n">bin_size</span><span class="p">)</span>
    <span class="n">hist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bin_edges</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span>
    <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">save_to</span> <span class="o">+</span> <span class="n">sim_name</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="n">edge_name</span> <span class="o">+</span> <span class="s1">&#39;.npy&#39;</span><span class="p">,</span> <span class="n">bin_edges</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">bin_edges</span><span class="p">,</span> <span class="n">hist</span>


<span class="k">def</span> <span class="nf">fixedsize_bins</span><span class="p">(</span>
    <span class="n">sim_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">edge_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">bin_size</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">lmin</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">lmax</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">bin_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;ordinary&#39;</span><span class="p">,</span>
    <span class="n">save_to</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    generates arrays of bins and histograms, ensuring that the `bin_size` \</span>
<span class="sd">    guaranteed. To achieve this, it extend the `lmin` and `lmax` limits.</span>

<span class="sd">    To-do List</span>
<span class="sd">    ----------</span>
<span class="sd">    1. Following the idea used:</span>
<span class="sd">    https://docs.mdanalysis.org/1.1.1/_modules/MDAnalysis/lib/util.html#fixedwidth_bins</span>
<span class="sd">    Makes input array-like so bins can be calculated for 1D data (then all \</span>
<span class="sd">    parameters are simple floats) or nD data (then parameters are supplied \</span>
<span class="sd">    as arrays, with each entry corresponding to one dimension).</span>
<span class="sd">    2. Eliminate the if-statement for the periodic_bin_edges.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    sim_name: str</span>
<span class="sd">        Name of the simulation.</span>
<span class="sd">    edge_name: str</span>
<span class="sd">        Name of the variable for which the histogram is computed.</span>
<span class="sd">    bin_size : float</span>
<span class="sd">        Size of each bin.</span>
<span class="sd">    lmin : float</span>
<span class="sd">        Lower bound of the system in the direction of interest.</span>
<span class="sd">    lmax : float</span>
<span class="sd">        Upper bound of the system in the direction of interest.</span>
<span class="sd">    bin_type: {&#39;ordinary&#39;, &#39;nonnegative&#39;, &#39;periodic&#39;}, default &#39;ordinary&#39;</span>
<span class="sd">        The type of bin in a given direction in a given coordinate system:</span>

<span class="sd">        &#39;ordinary&#39;</span>
<span class="sd">            A bounded or unbounded coordinate such as any of the cartesian \</span>
<span class="sd">            coordinates or the polar coordinate in the spherical coordinate \</span>
<span class="sd">            system. For such coordinates, the `lmin` and `lmax` limits are \</span>
<span class="sd">            equally extended to ensure the `bin_size`.</span>

<span class="sd">        &#39;nonnegative&#39;</span>
<span class="sd">            A nonnegative coordinate such as the r direction in the polar \</span>
<span class="sd">            or spherical coordinate system. For such coordinates, ONLY `lmax` \</span>
<span class="sd">            limit is extended to ensure the `bin_size`.</span>

<span class="sd">        &#39;periodic&#39;</span>
<span class="sd">            A periodic coordinate such as the azimuthal direction in the \</span>
<span class="sd">            spherical coordinate. For such coordinates, the initial `lmin` \</span>
<span class="sd">            and `lmax` limits are used.</span>

<span class="sd">    save_to : str, default None</span>
<span class="sd">        Whether save outputs to memory as csv files or not.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    bin_edges : numpy array of  float</span>
<span class="sd">        The edges to pass into a histogram. Save `bin_edges` to file if \</span>
<span class="sd">        `save_to` is not None.</span>
<span class="sd">    hist: array of  int</span>
<span class="sd">        An empty histogram</span>

<span class="sd">    Reference:</span>
<span class="sd">    https://docs.mdanalysis.org/1.1.1/documentation_pages/lib/util.html#MDAnalysis.analysis.density.fixedwidth_bins</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">hist_collectors</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">bin_edges</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">bin_types</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ordinary&#39;</span><span class="p">,</span> <span class="s1">&#39;nonnagative&#39;</span><span class="p">,</span> <span class="s1">&#39;periodic&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">lmin</span> <span class="o">&lt;</span> <span class="n">lmax</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Boundaries are not sane: should be xmin &lt; xmax.&#39;</span><span class="p">)</span>
    <span class="n">_delta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">bin_size</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float_</span><span class="p">)</span>
    <span class="n">_lmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">lmin</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float_</span><span class="p">)</span>
    <span class="n">_lmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">lmax</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float_</span><span class="p">)</span>
    <span class="n">_length</span> <span class="o">=</span> <span class="n">_lmax</span> <span class="o">-</span> <span class="n">_lmin</span>
    <span class="k">if</span> <span class="n">bin_type</span> <span class="o">==</span> <span class="s1">&#39;ordinary&#39;</span><span class="p">:</span>
        <span class="n">n_bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">_length</span> <span class="o">/</span> <span class="n">_delta</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int_</span><span class="p">)</span>  <span class="c1"># number of bins</span>
        <span class="n">dx</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">n_bins</span> <span class="o">*</span> <span class="n">_delta</span> <span class="o">-</span> <span class="n">_length</span><span class="p">)</span>
        <span class="c1"># add half of the excess to each end:</span>
        <span class="n">_lmin</span> <span class="o">=</span> <span class="n">_lmin</span> <span class="o">-</span> <span class="n">dx</span>
        <span class="n">_lmax</span> <span class="o">=</span> <span class="n">_lmax</span> <span class="o">+</span> <span class="n">dx</span>
        <span class="c1"># create empty grid with the right dimensions (and get the edges)</span>
        <span class="n">hist_collectors</span><span class="p">,</span> <span class="n">bin_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
            <span class="n">bins</span><span class="o">=</span><span class="n">n_bins</span><span class="p">,</span>
            <span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="n">_lmin</span><span class="p">,</span> <span class="n">_lmax</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="n">bin_type</span> <span class="o">==</span> <span class="s1">&#39;nonnegative&#39;</span><span class="p">:</span>
        <span class="n">n_bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">_length</span> <span class="o">/</span> <span class="n">_delta</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int_</span><span class="p">)</span>
        <span class="n">dx</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">n_bins</span> <span class="o">*</span> <span class="n">_delta</span> <span class="o">-</span> <span class="n">_length</span><span class="p">)</span>
        <span class="c1"># add full of the excess to upper end:</span>
        <span class="n">_lmax</span> <span class="o">=</span> <span class="n">_lmax</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">dx</span>
        <span class="n">hist_collectors</span><span class="p">,</span> <span class="n">bin_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
            <span class="n">bins</span><span class="o">=</span><span class="n">n_bins</span><span class="p">,</span>
            <span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="n">_lmin</span><span class="p">,</span> <span class="n">_lmax</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="n">bin_type</span> <span class="o">==</span> <span class="s1">&#39;periodic&#39;</span><span class="p">:</span>
        <span class="n">bin_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">_lmin</span><span class="p">,</span> <span class="n">_lmax</span> <span class="o">+</span> <span class="n">_delta</span><span class="p">,</span> <span class="n">_delta</span><span class="p">)</span>
        <span class="n">hist_collectors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bin_edges</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">invalid_keyword</span><span class="p">(</span><span class="n">bin_type</span><span class="p">,</span> <span class="n">bin_types</span><span class="p">)</span>
    <span class="n">hist_collectors</span> <span class="o">*=</span> <span class="mi">0</span>
    <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">save_to</span> <span class="o">+</span> <span class="n">sim_name</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="n">edge_name</span> <span class="o">+</span> <span class="s1">&#39;.npy&#39;</span><span class="p">,</span> <span class="n">bin_edges</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">bin_edges</span><span class="p">,</span> <span class="n">hist_collectors</span>


<div class="viewcode-block" id="probe_bug"><a class="viewcode-back" href="../../../usage.html#polyphys.probe.prober.probe_bug">[docs]</a><span class="k">def</span> <span class="nf">probe_bug</span><span class="p">(</span>
    <span class="n">topology</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">trajectory</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">geometry</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;biaxial&#39;</span><span class="p">,</span>
    <span class="n">lineage</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;segment&#39;</span><span class="p">,</span>
    <span class="n">save_to</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;./&#39;</span><span class="p">,</span>
    <span class="n">continuous</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    runs various analyses on a `lineage` simulation of a &#39;bug&#39; atom group in \</span>
<span class="sd">    the `geometry` of interest.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    topology: str</span>
<span class="sd">        Name of the topology file.</span>
<span class="sd">    trajectory: str</span>
<span class="sd">        Name of the trajectory file.</span>
<span class="sd">    geometry : {&#39;biaxial&#39;, &#39;slit&#39;, &#39;box&#39;}, default &#39;biaxial&#39;</span>
<span class="sd">        Shape of the simulation box.</span>
<span class="sd">    lineage: {&#39;segment&#39;, &#39;whole&#39;}, default &#39;segment&#39;</span>
<span class="sd">        Type of the input file.</span>
<span class="sd">    save_to: str, default &#39;./&#39;</span>
<span class="sd">        The absolute/relative path of a directory to which outputs are saved.</span>
<span class="sd">    continuous: bool, default False</span>
<span class="sd">        Whether a `trajectory` file is a part of a sequence of trajectory \</span>
<span class="sd">        segments or not.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">lineage</span> <span class="o">==</span> <span class="s1">&#39;segment&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">continuous</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;lineage is &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">lineage</span><span class="si">}</span><span class="s2">&#39; &quot;</span>
            <span class="s2">&quot;and &#39;continuous&#39; is &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">continuous</span><span class="si">}</span><span class="s2">. &quot;</span>
            <span class="s2">&quot;Please ensure the &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">trajectory</span><span class="si">}</span><span class="s2">&#39; is NOT part of a sequence of trajectories.&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Setting the name of analyze file...&quot;</span><span class="p">)</span>
    <span class="n">sim_info</span> <span class="o">=</span> <span class="n">SumRule</span><span class="p">(</span>
        <span class="n">trajectory</span><span class="p">,</span>
        <span class="n">geometry</span><span class="o">=</span><span class="n">geometry</span><span class="p">,</span>
        <span class="n">group</span><span class="o">=</span><span class="s1">&#39;bug&#39;</span><span class="p">,</span>
        <span class="n">lineage</span><span class="o">=</span><span class="n">lineage</span>
    <span class="p">)</span>
    <span class="n">sim_name</span> <span class="o">=</span> <span class="n">sim_info</span><span class="o">.</span><span class="n">lineage_name</span> <span class="o">+</span> <span class="s2">&quot;-&quot;</span> <span class="o">+</span> <span class="n">sim_info</span><span class="o">.</span><span class="n">group</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">sim_name</span> <span class="o">+</span> <span class="s2">&quot; is analyzing...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="c1"># LJ time difference between two consecutive frames:</span>
    <span class="n">time_unit</span> <span class="o">=</span> <span class="n">sim_info</span><span class="o">.</span><span class="n">dmon</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sim_info</span><span class="o">.</span><span class="n">mmon</span> <span class="o">*</span> <span class="n">sim_info</span><span class="o">.</span><span class="n">eps_others</span><span class="p">)</span> \
        <span class="c1"># LJ time unit</span>
    <span class="n">lj_nstep</span> <span class="o">=</span> <span class="n">sim_info</span><span class="o">.</span><span class="n">bdump</span>  <span class="c1"># Sampling steps via dump command in Lammps</span>
    <span class="n">lj_dt</span> <span class="o">=</span> <span class="n">sim_info</span><span class="o">.</span><span class="n">dt</span>
    <span class="n">sim_real_dt</span> <span class="o">=</span> <span class="n">lj_nstep</span> <span class="o">*</span> <span class="n">lj_dt</span> <span class="o">*</span> <span class="n">time_unit</span>
    <span class="n">cell</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span>
        <span class="n">topology</span><span class="p">,</span> <span class="n">trajectory</span><span class="p">,</span> <span class="n">topology_format</span><span class="o">=</span><span class="s1">&#39;DATA&#39;</span><span class="p">,</span>
        <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;LAMMPSDUMP&#39;</span><span class="p">,</span> <span class="n">lammps_coordinate_convention</span><span class="o">=</span><span class="s1">&#39;unscaled&#39;</span><span class="p">,</span>
        <span class="n">atom_style</span><span class="o">=</span><span class="s2">&quot;id resid type x y z&quot;</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">sim_real_dt</span><span class="p">)</span>
    <span class="c1"># slicing trajectory based the continuous condition</span>
    <span class="k">if</span> <span class="n">continuous</span><span class="p">:</span>
        <span class="n">sliced_trj</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">trajectory</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">n_frames</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">n_frames</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">sliced_trj</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">trajectory</span>
        <span class="n">n_frames</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">n_frames</span>
    <span class="c1"># selecting atom groups</span>
    <span class="n">bug</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;resid 1&#39;</span><span class="p">)</span>  <span class="c1"># the polymer</span>
    <span class="c1"># dict of bin edges:</span>
    <span class="n">bin_edges</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;rfloryEdge&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;bin_size&#39;</span><span class="p">:</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">sim_info</span><span class="o">.</span><span class="n">dmon</span><span class="p">,</span>
            <span class="s1">&#39;lmax&#39;</span><span class="p">:</span> <span class="n">sim_info</span><span class="o">.</span><span class="n">nmon</span> <span class="o">*</span> <span class="n">sim_info</span><span class="o">.</span><span class="n">dmon</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="c1"># distribution of the size of the end-to-end</span>
    <span class="n">rflory_edges</span><span class="p">,</span> <span class="n">rflory_hist</span> <span class="o">=</span> <span class="n">fixedsize_bins</span><span class="p">(</span>
        <span class="n">sim_name</span><span class="p">,</span>
        <span class="s1">&#39;rfloryEdgeMon&#39;</span><span class="p">,</span>
        <span class="n">bin_edges</span><span class="p">[</span><span class="s1">&#39;rfloryEdge&#39;</span><span class="p">][</span><span class="s1">&#39;bin_size&#39;</span><span class="p">],</span>
        <span class="mi">0</span><span class="p">,</span>
        <span class="n">bin_edges</span><span class="p">[</span><span class="s1">&#39;rfloryEdge&#39;</span><span class="p">][</span><span class="s1">&#39;lmax&#39;</span><span class="p">],</span>
        <span class="n">bin_type</span><span class="o">=</span><span class="s1">&#39;nonnegative&#39;</span><span class="p">,</span>
        <span class="n">save_to</span><span class="o">=</span><span class="n">save_to</span>
    <span class="p">)</span>
    <span class="n">fsd_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">rflory_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">gyr_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">rflory_hist</span><span class="o">.</span><span class="n">any</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;One of the histogram collectors are not empty!&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">sliced_trj</span><span class="p">:</span>
        <span class="c1"># various measures of chain size</span>
        <span class="n">fsd_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fsd_t</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">fsd</span><span class="p">(</span><span class="n">bug</span><span class="o">.</span><span class="n">positions</span><span class="p">)]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">gyr_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gyr_t</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">bug</span><span class="o">.</span><span class="n">radius_of_gyration</span><span class="p">()]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">rms</span> <span class="o">=</span> <span class="n">end_to_end</span><span class="p">(</span><span class="n">bug</span><span class="o">.</span><span class="n">positions</span><span class="p">)</span>
        <span class="n">rflory_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rflory_t</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">rms</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">dummy_hist</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">rms</span><span class="p">,</span> <span class="n">rflory_edges</span><span class="p">)</span>
        <span class="c1"># RDF of the end-to-end distance</span>
        <span class="n">rflory_hist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rflory_hist</span><span class="p">,</span> <span class="n">dummy_hist</span><span class="p">)</span>
    <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">save_to</span> <span class="o">+</span> <span class="n">sim_name</span> <span class="o">+</span> <span class="s1">&#39;-rfloryHistMon.npy&#39;</span><span class="p">,</span> <span class="n">rflory_hist</span><span class="p">)</span>
    <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">save_to</span> <span class="o">+</span> <span class="n">sim_name</span> <span class="o">+</span> <span class="s1">&#39;-fsdTMon.npy&#39;</span><span class="p">,</span> <span class="n">fsd_t</span><span class="p">)</span>
    <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">save_to</span> <span class="o">+</span> <span class="n">sim_name</span> <span class="o">+</span> <span class="s1">&#39;-rfloryTMon.npy&#39;</span><span class="p">,</span> <span class="n">rflory_t</span><span class="p">)</span>
    <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">save_to</span> <span class="o">+</span> <span class="n">sim_name</span> <span class="o">+</span> <span class="s1">&#39;-gyrTMon.npy&#39;</span><span class="p">,</span> <span class="n">gyr_t</span><span class="p">)</span>
    <span class="c1"># Simulation stamps:</span>
    <span class="n">outfile</span> <span class="o">=</span> <span class="n">save_to</span> <span class="o">+</span> <span class="n">sim_name</span> <span class="o">+</span> <span class="s2">&quot;-stamps.csv&quot;</span>
    <span class="n">stamps_report</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="n">sim_info</span><span class="p">,</span> <span class="n">n_frames</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;done.&#39;</span><span class="p">)</span></div>


<span class="c1"># noinspection PyUnresolvedReferences</span>
<span class="k">def</span> <span class="nf">rmsd_bug</span><span class="p">(</span>
    <span class="n">topology</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">trajectory</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">geometry</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;biaxial&#39;</span><span class="p">,</span>
    <span class="n">lineage</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;segment&#39;</span><span class="p">,</span>
    <span class="n">save_to</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;./&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    computes the rmsd of a &#39;segment simulation of a &#39;bug&#39; atom group in the \</span>
<span class="sd">    `geometry` of interest, and then saves the output to the `save_to` \</span>
<span class="sd">    directory.</span>

<span class="sd">    `rmsd_bug` does not support the `continuous` option defined in \</span>
<span class="sd">    `probe_bug` and `probe_all`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    topology: str</span>
<span class="sd">        Name of the topology file.</span>
<span class="sd">    trajectory: str</span>
<span class="sd">        Name of the trajectory file.</span>
<span class="sd">    geometry : {&#39;biaxial&#39;, &#39;slit&#39;, &#39;box&#39;}, default &#39;biaxial&#39;</span>
<span class="sd">        Shape of the simulation box.</span>
<span class="sd">    lineage: {&#39;segment&#39;, &#39;whole&#39;}, default &#39;segment&#39;</span>
<span class="sd">        Type of the input file.</span>
<span class="sd">    save_to: str, default &#39;./&#39;</span>
<span class="sd">        The absolute/relative path of a directory to which output is saved.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">sim_info</span> <span class="o">=</span> <span class="n">SumRule</span><span class="p">(</span>
        <span class="n">trajectory</span><span class="p">,</span>
        <span class="n">geometry</span><span class="o">=</span><span class="n">geometry</span><span class="p">,</span>
        <span class="n">group</span><span class="o">=</span><span class="s1">&#39;bug&#39;</span><span class="p">,</span>
        <span class="n">lineage</span><span class="o">=</span><span class="n">lineage</span>
    <span class="p">)</span>
    <span class="n">sim_name</span> <span class="o">=</span> <span class="n">sim_info</span><span class="o">.</span><span class="n">lineage_name</span> <span class="o">+</span> <span class="s2">&quot;-&quot;</span> <span class="o">+</span> <span class="n">sim_info</span><span class="o">.</span><span class="n">group</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Doing RMSD analysis on </span><span class="si">{</span><span class="n">sim_name</span><span class="si">}</span><span class="s2"> ...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="c1"># LJ time difference between two consecutive frames:</span>
    <span class="n">time_unit</span> <span class="o">=</span> <span class="n">sim_info</span><span class="o">.</span><span class="n">dmon</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sim_info</span><span class="o">.</span><span class="n">mmon</span> <span class="o">*</span> <span class="n">sim_info</span><span class="o">.</span><span class="n">eps_others</span><span class="p">)</span> \
        <span class="c1"># LJ time unit</span>
    <span class="n">lj_nstep</span> <span class="o">=</span> <span class="n">sim_info</span><span class="o">.</span><span class="n">bdump</span>  <span class="c1"># Sampling steps via dump command in Lammps</span>
    <span class="n">lj_dt</span> <span class="o">=</span> <span class="n">sim_info</span><span class="o">.</span><span class="n">dt</span>
    <span class="n">sim_real_dt</span> <span class="o">=</span> <span class="n">lj_nstep</span> <span class="o">*</span> <span class="n">lj_dt</span> <span class="o">*</span> <span class="n">time_unit</span>
    <span class="n">cell</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span>
        <span class="n">topology</span><span class="p">,</span>
        <span class="n">trajectory</span><span class="p">,</span>
        <span class="n">topology_format</span><span class="o">=</span><span class="s1">&#39;DATA&#39;</span><span class="p">,</span>
        <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;LAMMPSDUMP&#39;</span><span class="p">,</span>
        <span class="n">lammps_coordinate_convention</span><span class="o">=</span><span class="s1">&#39;unscaled&#39;</span><span class="p">,</span>
        <span class="n">atom_style</span><span class="o">=</span><span class="s2">&quot;id resid type x y z&quot;</span><span class="p">,</span>
        <span class="n">dt</span><span class="o">=</span><span class="n">sim_real_dt</span>
    <span class="p">)</span>
    <span class="n">cell</span><span class="o">.</span><span class="n">transfer_to_memory</span><span class="p">(</span><span class="n">step</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">align</span><span class="o">.</span><span class="n">AlignTraj</span><span class="p">(</span>
        <span class="n">cell</span><span class="p">,</span>
        <span class="n">cell</span><span class="p">,</span>
        <span class="n">select</span><span class="o">=</span><span class="s1">&#39;resid 1&#39;</span><span class="p">,</span>
        <span class="n">filename</span><span class="o">=</span><span class="n">sim_name</span> <span class="o">+</span> <span class="s1">&#39;.dcd&#39;</span>
    <span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
    <span class="n">matrix</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">diffusionmap</span><span class="o">.</span><span class="n">DistanceMatrix</span><span class="p">(</span>
        <span class="n">cell</span><span class="p">,</span>
        <span class="n">select</span><span class="o">=</span><span class="s1">&#39;resid 1&#39;</span>
    <span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
    <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">save_to</span> <span class="o">+</span> <span class="n">sim_name</span> <span class="o">+</span> <span class="s1">&#39;-rmsdMatrixMon.npy&#39;</span><span class="p">,</span> <span class="n">matrix</span><span class="o">.</span><span class="n">dist_matrix</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">probe_all</span><span class="p">(</span>
    <span class="n">topology</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">trajectory</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">geometry</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;biaxial&#39;</span><span class="p">,</span>
    <span class="n">lineage</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;segment&#39;</span><span class="p">,</span>
    <span class="n">save_to</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;./&quot;</span><span class="p">,</span>
    <span class="n">continuous</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    runs various analyses on a `lineage` simulation of an &#39;all&#39; atom \</span>
<span class="sd">    group in the `geometry` of interest, and saves a variety of \</span>
<span class="sd">    outputs (mostly in the csv format) to the `save_to` directory.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    topology: str</span>
<span class="sd">        Name of the topology file.</span>
<span class="sd">    trajectory: str</span>
<span class="sd">        Name of the trajectory file.</span>
<span class="sd">    geometry : {&#39;biaxial&#39;, &#39;slit&#39;, &#39;box&#39;}, default &#39;biaxial</span>
<span class="sd">        Shape of the simulation box.</span>
<span class="sd">    lineage: {&#39;segment&#39;, &#39;whole&#39;}, default &#39;segment&#39;</span>
<span class="sd">        Type of the input file.</span>
<span class="sd">    save_to: str</span>
<span class="sd">        The absolute/relative path of a directory to which outputs are saved.</span>
<span class="sd">    continuous: bool, default False</span>
<span class="sd">        Whether a `trajectory` file is a part of a sequence of trajectory \</span>
<span class="sd">        segments or not.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">lineage</span> <span class="o">==</span> <span class="s1">&#39;segment&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">continuous</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;lineage is &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">lineage</span><span class="si">}</span><span class="s2">&#39; &quot;</span>
            <span class="s2">&quot;and &#39;continuous&#39; is &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">continuous</span><span class="si">}</span><span class="s2">. &quot;</span>
            <span class="s2">&quot;Please ensure the &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">trajectory</span><span class="si">}</span><span class="s2">&#39; is NOT part of a sequence of trajectories.&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Setting the name of analyze file...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">sim_info</span> <span class="o">=</span> <span class="n">SumRule</span><span class="p">(</span>
        <span class="n">trajectory</span><span class="p">,</span>
        <span class="n">geometry</span><span class="o">=</span><span class="n">geometry</span><span class="p">,</span>
        <span class="n">group</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span>
        <span class="n">lineage</span><span class="o">=</span><span class="n">lineage</span>
    <span class="p">)</span>
    <span class="n">sim_name</span> <span class="o">=</span> <span class="n">sim_info</span><span class="o">.</span><span class="n">lineage_name</span> <span class="o">+</span> <span class="s2">&quot;-&quot;</span> <span class="o">+</span> <span class="n">sim_info</span><span class="o">.</span><span class="n">group</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">sim_name</span> <span class="o">+</span> <span class="s2">&quot; is analyzing...&quot;</span><span class="p">)</span>
    <span class="c1"># dict of bin edges:</span>
    <span class="n">bin_edges</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;rEdge&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;bin_size&#39;</span><span class="p">:</span>  <span class="mf">0.1</span> <span class="o">*</span> <span class="nb">min</span><span class="p">(</span><span class="n">sim_info</span><span class="o">.</span><span class="n">dmon</span><span class="p">,</span> <span class="n">sim_info</span><span class="o">.</span><span class="n">dcrowd</span><span class="p">),</span>
            <span class="s1">&#39;lmax&#39;</span><span class="p">:</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">sim_info</span><span class="o">.</span><span class="n">dcyl</span>
            <span class="p">},</span>
        <span class="s1">&#39;zEdge&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;bin_size&#39;</span><span class="p">:</span>  <span class="mf">0.5</span> <span class="o">*</span> <span class="nb">min</span><span class="p">(</span><span class="n">sim_info</span><span class="o">.</span><span class="n">dmon</span><span class="p">,</span> <span class="n">sim_info</span><span class="o">.</span><span class="n">dcrowd</span><span class="p">),</span>
            <span class="s1">&#39;lmax&#39;</span><span class="p">:</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">sim_info</span><span class="o">.</span><span class="n">lcyl</span>
            <span class="p">},</span>
        <span class="s1">&#39;thetaEdge&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;bin_size&#39;</span><span class="p">:</span>  <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">36</span><span class="p">,</span>
            <span class="s1">&#39;lmax&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="c1"># LJ time difference between two consecutive frames:</span>
    <span class="n">time_unit</span> <span class="o">=</span> <span class="n">sim_info</span><span class="o">.</span><span class="n">dmon</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sim_info</span><span class="o">.</span><span class="n">mmon</span> <span class="o">*</span> <span class="n">sim_info</span><span class="o">.</span><span class="n">eps_others</span><span class="p">)</span> \
        <span class="c1"># LJ time unit</span>
    <span class="n">lj_nstep</span> <span class="o">=</span> <span class="n">sim_info</span><span class="o">.</span><span class="n">bdump</span>  <span class="c1"># Sampling steps via dump command in Lammps</span>
    <span class="n">lj_dt</span> <span class="o">=</span> <span class="n">sim_info</span><span class="o">.</span><span class="n">dt</span>
    <span class="n">sim_real_dt</span> <span class="o">=</span> <span class="n">lj_nstep</span> <span class="o">*</span> <span class="n">lj_dt</span> <span class="o">*</span> <span class="n">time_unit</span>
    <span class="n">cell</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span>
        <span class="n">topology</span><span class="p">,</span>
        <span class="n">trajectory</span><span class="p">,</span>
        <span class="n">topology_format</span><span class="o">=</span><span class="s1">&#39;DATA&#39;</span><span class="p">,</span>
        <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;LAMMPSDUMP&#39;</span><span class="p">,</span>
        <span class="n">lammps_coordinate_convention</span><span class="o">=</span><span class="s1">&#39;unscaled&#39;</span><span class="p">,</span>
        <span class="n">atom_style</span><span class="o">=</span><span class="s2">&quot;id resid type x y z&quot;</span><span class="p">,</span>
        <span class="n">dt</span><span class="o">=</span><span class="n">sim_real_dt</span>
    <span class="p">)</span>
    <span class="c1"># slicing trajectory based the continuous condition</span>
    <span class="k">if</span> <span class="n">continuous</span><span class="p">:</span>
        <span class="n">sliced_trj</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">trajectory</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">sliced_trj</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">trajectory</span>
    <span class="c1"># selecting atom groups</span>
    <span class="n">crds</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;resid 0&#39;</span><span class="p">)</span>  <span class="c1"># crowders</span>
    <span class="n">bug</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;resid 1&#39;</span><span class="p">)</span>  <span class="c1"># the chain or monomers</span>
    <span class="c1"># bin edges and histograms in different directions:</span>
    <span class="c1"># radial direction of the cylindrical coordinate system</span>
    <span class="n">r_edges</span><span class="p">,</span> <span class="n">r_hist_crd</span> <span class="o">=</span> <span class="n">fixedsize_bins</span><span class="p">(</span>
        <span class="n">sim_name</span><span class="p">,</span>
        <span class="s1">&#39;rEdgeCrd&#39;</span><span class="p">,</span>
        <span class="n">bin_edges</span><span class="p">[</span><span class="s1">&#39;rEdge&#39;</span><span class="p">][</span><span class="s1">&#39;bin_size&#39;</span><span class="p">],</span>
        <span class="mf">0.0</span><span class="p">,</span>
        <span class="n">bin_edges</span><span class="p">[</span><span class="s1">&#39;rEdge&#39;</span><span class="p">][</span><span class="s1">&#39;lmax&#39;</span><span class="p">],</span>
        <span class="n">bin_type</span><span class="o">=</span><span class="s1">&#39;nonnegative&#39;</span><span class="p">,</span>
        <span class="n">save_to</span><span class="o">=</span><span class="n">save_to</span>
    <span class="p">)</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">r_hist_mon</span> <span class="o">=</span> <span class="n">fixedsize_bins</span><span class="p">(</span>
        <span class="n">sim_name</span><span class="p">,</span>
        <span class="s1">&#39;rEdgeMon&#39;</span><span class="p">,</span>
        <span class="n">bin_edges</span><span class="p">[</span><span class="s1">&#39;rEdge&#39;</span><span class="p">][</span><span class="s1">&#39;bin_size&#39;</span><span class="p">],</span>
        <span class="mf">0.0</span><span class="p">,</span>
        <span class="n">bin_edges</span><span class="p">[</span><span class="s1">&#39;rEdge&#39;</span><span class="p">][</span><span class="s1">&#39;lmax&#39;</span><span class="p">],</span>
        <span class="n">bin_type</span><span class="o">=</span><span class="s1">&#39;nonnegative&#39;</span><span class="p">,</span>
        <span class="n">save_to</span><span class="o">=</span><span class="n">save_to</span>
    <span class="p">)</span>
    <span class="c1"># z direction of the cylindrical coordinate system</span>
    <span class="n">z_edges</span><span class="p">,</span> <span class="n">z_hist_crd</span> <span class="o">=</span> <span class="n">fixedsize_bins</span><span class="p">(</span>
        <span class="n">sim_name</span><span class="p">,</span>
        <span class="s1">&#39;zEdgeCrd&#39;</span><span class="p">,</span>
        <span class="n">bin_edges</span><span class="p">[</span><span class="s1">&#39;zEdge&#39;</span><span class="p">][</span><span class="s1">&#39;bin_size&#39;</span><span class="p">],</span>
        <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">bin_edges</span><span class="p">[</span><span class="s1">&#39;zEdge&#39;</span><span class="p">][</span><span class="s1">&#39;lmax&#39;</span><span class="p">],</span>
        <span class="n">bin_edges</span><span class="p">[</span><span class="s1">&#39;zEdge&#39;</span><span class="p">][</span><span class="s1">&#39;lmax&#39;</span><span class="p">],</span>
        <span class="n">bin_type</span><span class="o">=</span><span class="s1">&#39;ordinary&#39;</span><span class="p">,</span>
        <span class="n">save_to</span><span class="o">=</span><span class="n">save_to</span>
    <span class="p">)</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">z_hist_mon</span> <span class="o">=</span> <span class="n">fixedsize_bins</span><span class="p">(</span>
        <span class="n">sim_name</span><span class="p">,</span>
        <span class="s1">&#39;zEdgeMon&#39;</span><span class="p">,</span>
        <span class="n">bin_edges</span><span class="p">[</span><span class="s1">&#39;zEdge&#39;</span><span class="p">][</span><span class="s1">&#39;bin_size&#39;</span><span class="p">],</span>
        <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">bin_edges</span><span class="p">[</span><span class="s1">&#39;zEdge&#39;</span><span class="p">][</span><span class="s1">&#39;lmax&#39;</span><span class="p">],</span>
        <span class="n">bin_edges</span><span class="p">[</span><span class="s1">&#39;zEdge&#39;</span><span class="p">][</span><span class="s1">&#39;lmax&#39;</span><span class="p">],</span>
        <span class="n">bin_type</span><span class="o">=</span><span class="s1">&#39;ordinary&#39;</span><span class="p">,</span>
        <span class="n">save_to</span><span class="o">=</span><span class="n">save_to</span>
    <span class="p">)</span>
    <span class="c1"># theta of the cylindrical coordinate system</span>
    <span class="n">theta_edges</span><span class="p">,</span> <span class="n">theta_hist_crd</span> <span class="o">=</span> <span class="n">fixedsize_bins</span><span class="p">(</span>
        <span class="n">sim_name</span><span class="p">,</span> <span class="s1">&#39;thetaEdgeCrd&#39;</span><span class="p">,</span>
        <span class="n">bin_edges</span><span class="p">[</span><span class="s1">&#39;thetaEdge&#39;</span><span class="p">][</span><span class="s1">&#39;bin_size&#39;</span><span class="p">],</span>
        <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">bin_edges</span><span class="p">[</span><span class="s1">&#39;thetaEdge&#39;</span><span class="p">][</span><span class="s1">&#39;lmax&#39;</span><span class="p">],</span>
        <span class="n">bin_edges</span><span class="p">[</span><span class="s1">&#39;thetaEdge&#39;</span><span class="p">][</span><span class="s1">&#39;lmax&#39;</span><span class="p">],</span>
        <span class="n">bin_type</span><span class="o">=</span><span class="s1">&#39;periodic&#39;</span><span class="p">,</span>
        <span class="n">save_to</span><span class="o">=</span><span class="n">save_to</span>
    <span class="p">)</span>  <span class="c1"># in radians</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">theta_hist_mon</span> <span class="o">=</span> <span class="n">fixedsize_bins</span><span class="p">(</span>
        <span class="n">sim_name</span><span class="p">,</span>
        <span class="s1">&#39;thetaEdgeMon&#39;</span><span class="p">,</span>
        <span class="n">bin_edges</span><span class="p">[</span><span class="s1">&#39;thetaEdge&#39;</span><span class="p">][</span><span class="s1">&#39;bin_size&#39;</span><span class="p">],</span>
        <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">bin_edges</span><span class="p">[</span><span class="s1">&#39;thetaEdge&#39;</span><span class="p">][</span><span class="s1">&#39;lmax&#39;</span><span class="p">],</span>
        <span class="n">bin_edges</span><span class="p">[</span><span class="s1">&#39;thetaEdge&#39;</span><span class="p">][</span><span class="s1">&#39;lmax&#39;</span><span class="p">],</span>
        <span class="n">bin_type</span><span class="o">=</span><span class="s1">&#39;periodic&#39;</span><span class="p">,</span>
        <span class="n">save_to</span><span class="o">=</span><span class="n">save_to</span>
    <span class="p">)</span>  <span class="c1"># in radians</span>
    <span class="c1"># check if any of the histograms are empty or not.</span>
    <span class="k">if</span> <span class="nb">any</span><span class="p">([</span>
            <span class="n">r_hist_crd</span><span class="o">.</span><span class="n">any</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">r_hist_mon</span><span class="o">.</span><span class="n">any</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">,</span>
            <span class="n">z_hist_crd</span><span class="o">.</span><span class="n">any</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">z_hist_mon</span><span class="o">.</span><span class="n">any</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">,</span>
            <span class="n">theta_hist_crd</span><span class="o">.</span><span class="n">any</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">theta_hist_mon</span><span class="o">.</span><span class="n">any</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">0</span>
            <span class="p">]):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;One of the histogram collectors are not empty!&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">sliced_trj</span><span class="p">:</span>
        <span class="c1"># histogram in r direction</span>
        <span class="n">r_coor</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">crds</span><span class="o">.</span><span class="n">positions</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">dummy_hist</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">r_coor</span><span class="p">,</span> <span class="n">r_edges</span><span class="p">)</span>
        <span class="n">r_hist_crd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">r_hist_crd</span><span class="p">,</span> <span class="n">dummy_hist</span><span class="p">)</span>
        <span class="n">r_coor</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">bug</span><span class="o">.</span><span class="n">positions</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">dummy_hist</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">r_coor</span><span class="p">,</span> <span class="n">r_edges</span><span class="p">)</span>
        <span class="n">r_hist_mon</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">r_hist_mon</span><span class="p">,</span> <span class="n">dummy_hist</span><span class="p">)</span>
        <span class="c1"># histogram in z direction</span>
        <span class="n">z_coor</span> <span class="o">=</span> <span class="n">crds</span><span class="o">.</span><span class="n">positions</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>
        <span class="n">dummy_hist</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">z_coor</span><span class="p">,</span> <span class="n">z_edges</span><span class="p">)</span>
        <span class="n">z_hist_crd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">z_hist_crd</span><span class="p">,</span> <span class="n">dummy_hist</span><span class="p">)</span>
        <span class="n">z_coor</span> <span class="o">=</span> <span class="n">bug</span><span class="o">.</span><span class="n">positions</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>
        <span class="n">dummy_hist</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">z_coor</span><span class="p">,</span> <span class="n">z_edges</span><span class="p">)</span>
        <span class="n">z_hist_mon</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">z_hist_mon</span><span class="p">,</span> <span class="n">dummy_hist</span><span class="p">)</span>
        <span class="c1"># histogram in theta</span>
        <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span>
            <span class="n">crds</span><span class="o">.</span><span class="n">positions</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>
            <span class="n">crds</span><span class="o">.</span><span class="n">positions</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="p">)</span>  <span class="c1"># in degrees</span>
        <span class="n">dummy_hist</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">theta_edges</span><span class="p">)</span>
        <span class="n">theta_hist_crd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">theta_hist_crd</span><span class="p">,</span> <span class="n">dummy_hist</span><span class="p">)</span>
        <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span>
            <span class="n">bug</span><span class="o">.</span><span class="n">positions</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>
            <span class="n">bug</span><span class="o">.</span><span class="n">positions</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="p">)</span>  <span class="c1"># in degrees</span>
        <span class="n">dummy_hist</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">theta_edges</span><span class="p">)</span>
        <span class="n">theta_hist_mon</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">theta_hist_mon</span><span class="p">,</span> <span class="n">dummy_hist</span><span class="p">)</span>
    <span class="n">lastname</span> <span class="o">=</span> <span class="s1">&#39;Crd&#39;</span>
    <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">save_to</span> <span class="o">+</span> <span class="n">sim_name</span> <span class="o">+</span> <span class="s1">&#39;-rHist&#39;</span> <span class="o">+</span> <span class="n">lastname</span> <span class="o">+</span> <span class="s1">&#39;.npy&#39;</span><span class="p">,</span> <span class="n">r_hist_crd</span><span class="p">)</span>
    <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">save_to</span> <span class="o">+</span> <span class="n">sim_name</span> <span class="o">+</span> <span class="s1">&#39;-zHist&#39;</span> <span class="o">+</span> <span class="n">lastname</span> <span class="o">+</span> <span class="s1">&#39;.npy&#39;</span><span class="p">,</span> <span class="n">z_hist_crd</span><span class="p">)</span>
    <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span>
        <span class="n">save_to</span> <span class="o">+</span> <span class="n">sim_name</span> <span class="o">+</span> <span class="s1">&#39;-thetaHist&#39;</span> <span class="o">+</span> <span class="n">lastname</span> <span class="o">+</span> <span class="s1">&#39;.npy&#39;</span><span class="p">,</span> <span class="n">theta_hist_crd</span>
    <span class="p">)</span>
    <span class="n">lastname</span> <span class="o">=</span> <span class="s1">&#39;Mon&#39;</span>
    <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">save_to</span> <span class="o">+</span> <span class="n">sim_name</span> <span class="o">+</span> <span class="s1">&#39;-rHist&#39;</span> <span class="o">+</span> <span class="n">lastname</span> <span class="o">+</span> <span class="s1">&#39;.npy&#39;</span><span class="p">,</span> <span class="n">r_hist_mon</span><span class="p">)</span>
    <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">save_to</span> <span class="o">+</span> <span class="n">sim_name</span> <span class="o">+</span> <span class="s1">&#39;-zHist&#39;</span> <span class="o">+</span> <span class="n">lastname</span> <span class="o">+</span> <span class="s1">&#39;.npy&#39;</span><span class="p">,</span> <span class="n">z_hist_mon</span><span class="p">)</span>
    <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span>
        <span class="n">save_to</span> <span class="o">+</span> <span class="n">sim_name</span> <span class="o">+</span> <span class="s1">&#39;-thetaHist&#39;</span> <span class="o">+</span> <span class="n">lastname</span> <span class="o">+</span> <span class="s1">&#39;.npy&#39;</span><span class="p">,</span> <span class="n">theta_hist_mon</span>
    <span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;done.&#39;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">probe_all_new</span><span class="p">(</span>
    <span class="n">topology</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">trajectory</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">geometry</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;biaxial&#39;</span><span class="p">,</span>
    <span class="n">lineage</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;segment&#39;</span><span class="p">,</span>
    <span class="n">save_to</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;./&#39;</span><span class="p">,</span>
    <span class="n">continuous</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    runs various analyses on a `lineage` simulation of an &#39;all&#39; atom \</span>
<span class="sd">    group in the `geometry` of interest, and saves a variety of \</span>
<span class="sd">    outputs (mostly in the csv format) to the `save_to` directory.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    topology: str</span>
<span class="sd">        Name of the topology file.</span>
<span class="sd">    trajectory: str</span>
<span class="sd">        Name of the trajectory file.</span>
<span class="sd">    geometry : {&#39;biaxial&#39;, &#39;slit&#39;, &#39;box&#39;}, default &#39;biaxial</span>
<span class="sd">        Shape of the simulation box.</span>
<span class="sd">    lineage: {&#39;segment&#39;, &#39;whole&#39;}, default &#39;segment&#39;</span>
<span class="sd">        Type of the input file.</span>
<span class="sd">    save_to: str</span>
<span class="sd">        The absolute/relative path of a directory to which outputs are saved.</span>
<span class="sd">    continuous: bool, default False</span>
<span class="sd">        Whether a `trajectory` file is a part of a sequence of trajectory \</span>
<span class="sd">        segments or not.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">lineage</span> <span class="o">==</span> <span class="s1">&#39;segment&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">continuous</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;lineage is &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">lineage</span><span class="si">}</span><span class="s2">&#39; &quot;</span>
            <span class="s2">&quot;and &#39;continuous&#39; is &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">continuous</span><span class="si">}</span><span class="s2">. &quot;</span>
            <span class="s2">&quot;Please ensure the &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">trajectory</span><span class="si">}</span><span class="s2">&#39; is NOT part of a sequence of trajectories.&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Setting the name of analyze file...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">sim_info</span> <span class="o">=</span> <span class="n">SumRule</span><span class="p">(</span>
        <span class="n">trajectory</span><span class="p">,</span>
        <span class="n">geometry</span><span class="o">=</span><span class="n">geometry</span><span class="p">,</span>
        <span class="n">group</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span>
        <span class="n">lineage</span><span class="o">=</span><span class="n">lineage</span>
    <span class="p">)</span>
    <span class="n">sim_name</span> <span class="o">=</span> <span class="n">sim_info</span><span class="o">.</span><span class="n">lineage_name</span> <span class="o">+</span> <span class="s2">&quot;-&quot;</span> <span class="o">+</span> <span class="n">sim_info</span><span class="o">.</span><span class="n">group</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">sim_name</span> <span class="o">+</span> <span class="s2">&quot; is analyzing...&quot;</span><span class="p">)</span>
    <span class="c1"># dict of bin edges:</span>
    <span class="n">bin_edges</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;rEdge&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;bin_size&#39;</span><span class="p">:</span>  <span class="mf">0.1</span> <span class="o">*</span> <span class="nb">min</span><span class="p">(</span><span class="n">sim_info</span><span class="o">.</span><span class="n">dmon</span><span class="p">,</span> <span class="n">sim_info</span><span class="o">.</span><span class="n">dcrowd</span><span class="p">),</span>
            <span class="s1">&#39;lmax&#39;</span><span class="p">:</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">sim_info</span><span class="o">.</span><span class="n">dcyl</span> <span class="o">+</span> <span class="nb">min</span><span class="p">(</span><span class="n">sim_info</span><span class="o">.</span><span class="n">dmon</span><span class="p">,</span> <span class="n">sim_info</span><span class="o">.</span><span class="n">dcrowd</span><span class="p">)</span>
            <span class="p">},</span>
        <span class="s1">&#39;zEdge&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;bin_size&#39;</span><span class="p">:</span>  <span class="mf">0.5</span> <span class="o">*</span> <span class="nb">min</span><span class="p">(</span><span class="n">sim_info</span><span class="o">.</span><span class="n">dmon</span><span class="p">,</span> <span class="n">sim_info</span><span class="o">.</span><span class="n">dcrowd</span><span class="p">),</span>
            <span class="s1">&#39;lmax&#39;</span><span class="p">:</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">sim_info</span><span class="o">.</span><span class="n">lcyl</span> <span class="o">+</span> <span class="nb">min</span><span class="p">(</span><span class="n">sim_info</span><span class="o">.</span><span class="n">dmon</span><span class="p">,</span> <span class="n">sim_info</span><span class="o">.</span><span class="n">dcrowd</span><span class="p">)</span>
            <span class="p">},</span>
        <span class="s1">&#39;thetaEdge&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;bin_size&#39;</span><span class="p">:</span>  <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">36</span><span class="p">,</span>
            <span class="s1">&#39;lmax&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">36</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="c1"># LJ time difference between two consecutive frames:</span>
    <span class="n">time_unit</span> <span class="o">=</span> <span class="n">sim_info</span><span class="o">.</span><span class="n">dmon</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sim_info</span><span class="o">.</span><span class="n">mmon</span> <span class="o">*</span> <span class="n">sim_info</span><span class="o">.</span><span class="n">eps_others</span><span class="p">)</span> \
        <span class="c1"># LJ time unit</span>
    <span class="n">lj_nstep</span> <span class="o">=</span> <span class="n">sim_info</span><span class="o">.</span><span class="n">bdump</span>  <span class="c1"># Sampling steps via dump command in Lammps</span>
    <span class="n">lj_dt</span> <span class="o">=</span> <span class="n">sim_info</span><span class="o">.</span><span class="n">dt</span>
    <span class="n">sim_real_dt</span> <span class="o">=</span> <span class="n">lj_nstep</span> <span class="o">*</span> <span class="n">lj_dt</span> <span class="o">*</span> <span class="n">time_unit</span>
    <span class="n">cell</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span>
        <span class="n">topology</span><span class="p">,</span>
        <span class="n">trajectory</span><span class="p">,</span>
        <span class="n">topology_format</span><span class="o">=</span><span class="s1">&#39;DATA&#39;</span><span class="p">,</span>
        <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;LAMMPSDUMP&#39;</span><span class="p">,</span>
        <span class="n">lammps_coordinate_convention</span><span class="o">=</span><span class="s1">&#39;unscaled&#39;</span><span class="p">,</span>
        <span class="n">atom_style</span><span class="o">=</span><span class="s2">&quot;id resid type x y z&quot;</span><span class="p">,</span>
        <span class="n">dt</span><span class="o">=</span><span class="n">sim_real_dt</span>
    <span class="p">)</span>
    <span class="c1"># slicing trajectory based the continuous condition</span>
    <span class="k">if</span> <span class="n">continuous</span><span class="p">:</span>
        <span class="n">sliced_trj</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">trajectory</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">sliced_trj</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">trajectory</span>
    <span class="c1"># selecting atom groups</span>
    <span class="n">crds</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;resid 0&#39;</span><span class="p">)</span>  <span class="c1"># crowders</span>
    <span class="n">bug</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">select_atoms</span><span class="p">(</span><span class="s1">&#39;resid 1&#39;</span><span class="p">)</span>  <span class="c1"># the chain or monomers</span>
    <span class="c1"># bin edges and histograms in different directions:</span>
    <span class="c1"># radial direction of the cylindrical coordinate system</span>
    <span class="n">r_edges</span><span class="p">,</span> <span class="n">r_hist_crd</span> <span class="o">=</span> <span class="n">fixedsize_bins</span><span class="p">(</span>
        <span class="n">sim_name</span><span class="p">,</span>
        <span class="s1">&#39;rEdgeCrd&#39;</span><span class="p">,</span>
        <span class="n">bin_edges</span><span class="p">[</span><span class="s1">&#39;rEdge&#39;</span><span class="p">][</span><span class="s1">&#39;bin_size&#39;</span><span class="p">],</span>
        <span class="mf">0.0</span><span class="p">,</span>
        <span class="n">bin_edges</span><span class="p">[</span><span class="s1">&#39;rEdge&#39;</span><span class="p">][</span><span class="s1">&#39;lmax&#39;</span><span class="p">],</span>
        <span class="n">bin_type</span><span class="o">=</span><span class="s1">&#39;nonnegative&#39;</span><span class="p">,</span>
        <span class="n">save_to</span><span class="o">=</span><span class="n">save_to</span>
    <span class="p">)</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">r_hist_mon</span> <span class="o">=</span> <span class="n">fixedsize_bins</span><span class="p">(</span>
        <span class="n">sim_name</span><span class="p">,</span>
        <span class="s1">&#39;rEdgeMon&#39;</span><span class="p">,</span>
        <span class="n">bin_edges</span><span class="p">[</span><span class="s1">&#39;rEdge&#39;</span><span class="p">][</span><span class="s1">&#39;bin_size&#39;</span><span class="p">],</span>
        <span class="mf">0.0</span><span class="p">,</span>
        <span class="n">bin_edges</span><span class="p">[</span><span class="s1">&#39;rEdge&#39;</span><span class="p">][</span><span class="s1">&#39;lmax&#39;</span><span class="p">],</span>
        <span class="n">bin_type</span><span class="o">=</span><span class="s1">&#39;nonnegative&#39;</span><span class="p">,</span>
        <span class="n">save_to</span><span class="o">=</span><span class="n">save_to</span>
    <span class="p">)</span>
    <span class="c1"># z direction of the cylindrical coordinate system</span>
    <span class="n">z_edges</span><span class="p">,</span> <span class="n">z_hist_crd</span> <span class="o">=</span> <span class="n">fixedsize_bins</span><span class="p">(</span>
        <span class="n">sim_name</span><span class="p">,</span>
        <span class="s1">&#39;zEdgeCrd&#39;</span><span class="p">,</span>
        <span class="n">bin_edges</span><span class="p">[</span><span class="s1">&#39;zEdge&#39;</span><span class="p">][</span><span class="s1">&#39;bin_size&#39;</span><span class="p">],</span>
        <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">bin_edges</span><span class="p">[</span><span class="s1">&#39;zEdge&#39;</span><span class="p">][</span><span class="s1">&#39;lmax&#39;</span><span class="p">],</span>
        <span class="n">bin_edges</span><span class="p">[</span><span class="s1">&#39;zEdge&#39;</span><span class="p">][</span><span class="s1">&#39;lmax&#39;</span><span class="p">],</span>
        <span class="n">bin_type</span><span class="o">=</span><span class="s1">&#39;ordinary&#39;</span><span class="p">,</span>
        <span class="n">save_to</span><span class="o">=</span><span class="n">save_to</span>
    <span class="p">)</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">z_hist_mon</span> <span class="o">=</span> <span class="n">fixedsize_bins</span><span class="p">(</span>
        <span class="n">sim_name</span><span class="p">,</span>
        <span class="s1">&#39;zEdgeMon&#39;</span><span class="p">,</span>
        <span class="n">bin_edges</span><span class="p">[</span><span class="s1">&#39;zEdge&#39;</span><span class="p">][</span><span class="s1">&#39;bin_size&#39;</span><span class="p">],</span>
        <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">bin_edges</span><span class="p">[</span><span class="s1">&#39;zEdge&#39;</span><span class="p">][</span><span class="s1">&#39;lmax&#39;</span><span class="p">],</span>
        <span class="n">bin_edges</span><span class="p">[</span><span class="s1">&#39;zEdge&#39;</span><span class="p">][</span><span class="s1">&#39;lmax&#39;</span><span class="p">],</span>
        <span class="n">bin_type</span><span class="o">=</span><span class="s1">&#39;ordinary&#39;</span><span class="p">,</span>
        <span class="n">save_to</span><span class="o">=</span><span class="n">save_to</span>
    <span class="p">)</span>
    <span class="c1"># theta of the cylindrical coordinate system</span>
    <span class="n">theta_edges</span><span class="p">,</span> <span class="n">theta_hist_crd</span> <span class="o">=</span> <span class="n">fixedsize_bins</span><span class="p">(</span>
        <span class="n">sim_name</span><span class="p">,</span> <span class="s1">&#39;thetaEdgeCrd&#39;</span><span class="p">,</span>
        <span class="n">bin_edges</span><span class="p">[</span><span class="s1">&#39;thetaEdge&#39;</span><span class="p">][</span><span class="s1">&#39;bin_size&#39;</span><span class="p">],</span>
        <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">bin_edges</span><span class="p">[</span><span class="s1">&#39;thetaEdge&#39;</span><span class="p">][</span><span class="s1">&#39;lmax&#39;</span><span class="p">],</span>
        <span class="n">bin_edges</span><span class="p">[</span><span class="s1">&#39;thetaEdge&#39;</span><span class="p">][</span><span class="s1">&#39;lmax&#39;</span><span class="p">],</span>
        <span class="n">bin_type</span><span class="o">=</span><span class="s1">&#39;periodic&#39;</span><span class="p">,</span>
        <span class="n">save_to</span><span class="o">=</span><span class="n">save_to</span>
    <span class="p">)</span>  <span class="c1"># in radians</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">theta_hist_mon</span> <span class="o">=</span> <span class="n">fixedsize_bins</span><span class="p">(</span>
        <span class="n">sim_name</span><span class="p">,</span>
        <span class="s1">&#39;thetaEdgeMon&#39;</span><span class="p">,</span>
        <span class="n">bin_edges</span><span class="p">[</span><span class="s1">&#39;thetaEdge&#39;</span><span class="p">][</span><span class="s1">&#39;bin_size&#39;</span><span class="p">],</span>
        <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">bin_edges</span><span class="p">[</span><span class="s1">&#39;thetaEdge&#39;</span><span class="p">][</span><span class="s1">&#39;lmax&#39;</span><span class="p">],</span>
        <span class="n">bin_edges</span><span class="p">[</span><span class="s1">&#39;thetaEdge&#39;</span><span class="p">][</span><span class="s1">&#39;lmax&#39;</span><span class="p">],</span>
        <span class="n">bin_type</span><span class="o">=</span><span class="s1">&#39;periodic&#39;</span><span class="p">,</span>
        <span class="n">save_to</span><span class="o">=</span><span class="n">save_to</span>
    <span class="p">)</span>  <span class="c1"># in radians</span>
    <span class="c1"># check if any of the histograms are empty or not.</span>
    <span class="k">if</span> <span class="nb">any</span><span class="p">([</span>
            <span class="n">r_hist_crd</span><span class="o">.</span><span class="n">any</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">r_hist_mon</span><span class="o">.</span><span class="n">any</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">,</span>
            <span class="n">z_hist_crd</span><span class="o">.</span><span class="n">any</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">z_hist_mon</span><span class="o">.</span><span class="n">any</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">,</span>
            <span class="n">theta_hist_crd</span><span class="o">.</span><span class="n">any</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">theta_hist_mon</span><span class="o">.</span><span class="n">any</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">0</span>
            <span class="p">]):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;One of the histogram collectors are not empty!&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">sliced_trj</span><span class="p">:</span>
        <span class="c1"># histogram in r direction</span>
        <span class="n">r_coor</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">crds</span><span class="o">.</span><span class="n">positions</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">dummy_hist</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">r_coor</span><span class="p">,</span> <span class="n">r_edges</span><span class="p">)</span>
        <span class="n">r_hist_crd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">r_hist_crd</span><span class="p">,</span> <span class="n">dummy_hist</span><span class="p">)</span>
        <span class="n">r_coor</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">bug</span><span class="o">.</span><span class="n">positions</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">dummy_hist</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">r_coor</span><span class="p">,</span> <span class="n">r_edges</span><span class="p">)</span>
        <span class="n">r_hist_mon</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">r_hist_mon</span><span class="p">,</span> <span class="n">dummy_hist</span><span class="p">)</span>
        <span class="c1"># histogram in z direction</span>
        <span class="n">z_coor</span> <span class="o">=</span> <span class="n">crds</span><span class="o">.</span><span class="n">positions</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>
        <span class="n">dummy_hist</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">z_coor</span><span class="p">,</span> <span class="n">z_edges</span><span class="p">)</span>
        <span class="n">z_hist_crd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">z_hist_crd</span><span class="p">,</span> <span class="n">dummy_hist</span><span class="p">)</span>
        <span class="n">z_coor</span> <span class="o">=</span> <span class="n">bug</span><span class="o">.</span><span class="n">positions</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>
        <span class="n">dummy_hist</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">z_coor</span><span class="p">,</span> <span class="n">z_edges</span><span class="p">)</span>
        <span class="n">z_hist_mon</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">z_hist_mon</span><span class="p">,</span> <span class="n">dummy_hist</span><span class="p">)</span>
        <span class="c1"># histogram in theta</span>
        <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span>
            <span class="n">crds</span><span class="o">.</span><span class="n">positions</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>
            <span class="n">crds</span><span class="o">.</span><span class="n">positions</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="p">)</span>  <span class="c1"># in degrees</span>
        <span class="n">dummy_hist</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">theta_edges</span><span class="p">)</span>
        <span class="n">theta_hist_crd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">theta_hist_crd</span><span class="p">,</span> <span class="n">dummy_hist</span><span class="p">)</span>
        <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span>
            <span class="n">bug</span><span class="o">.</span><span class="n">positions</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>
            <span class="n">bug</span><span class="o">.</span><span class="n">positions</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="p">)</span>  <span class="c1"># in degrees</span>
        <span class="n">dummy_hist</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">theta_edges</span><span class="p">)</span>
        <span class="n">theta_hist_mon</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">theta_hist_mon</span><span class="p">,</span> <span class="n">dummy_hist</span><span class="p">)</span>
    <span class="n">lastname</span> <span class="o">=</span> <span class="s1">&#39;Crd&#39;</span>
    <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">save_to</span> <span class="o">+</span> <span class="n">sim_name</span> <span class="o">+</span> <span class="s1">&#39;-rHist&#39;</span> <span class="o">+</span> <span class="n">lastname</span> <span class="o">+</span> <span class="s1">&#39;.npy&#39;</span><span class="p">,</span> <span class="n">r_hist_crd</span><span class="p">)</span>
    <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">save_to</span> <span class="o">+</span> <span class="n">sim_name</span> <span class="o">+</span> <span class="s1">&#39;-zHist&#39;</span> <span class="o">+</span> <span class="n">lastname</span> <span class="o">+</span> <span class="s1">&#39;.npy&#39;</span><span class="p">,</span> <span class="n">z_hist_crd</span><span class="p">)</span>
    <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span>
        <span class="n">save_to</span> <span class="o">+</span> <span class="n">sim_name</span> <span class="o">+</span> <span class="s1">&#39;-thetaHist&#39;</span> <span class="o">+</span> <span class="n">lastname</span> <span class="o">+</span> <span class="s1">&#39;.npy&#39;</span><span class="p">,</span> <span class="n">theta_hist_crd</span>
    <span class="p">)</span>
    <span class="n">lastname</span> <span class="o">=</span> <span class="s1">&#39;Mon&#39;</span>
    <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">save_to</span> <span class="o">+</span> <span class="n">sim_name</span> <span class="o">+</span> <span class="s1">&#39;-rHist&#39;</span> <span class="o">+</span> <span class="n">lastname</span> <span class="o">+</span> <span class="s1">&#39;.npy&#39;</span><span class="p">,</span> <span class="n">r_hist_mon</span><span class="p">)</span>
    <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">save_to</span> <span class="o">+</span> <span class="n">sim_name</span> <span class="o">+</span> <span class="s1">&#39;-zHist&#39;</span> <span class="o">+</span> <span class="n">lastname</span> <span class="o">+</span> <span class="s1">&#39;.npy&#39;</span><span class="p">,</span> <span class="n">z_hist_mon</span><span class="p">)</span>
    <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span>
        <span class="n">save_to</span> <span class="o">+</span> <span class="n">sim_name</span> <span class="o">+</span> <span class="s1">&#39;-thetaHist&#39;</span> <span class="o">+</span> <span class="n">lastname</span> <span class="o">+</span> <span class="s1">&#39;.npy&#39;</span><span class="p">,</span> <span class="n">theta_hist_mon</span>
    <span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;done.&#39;</span><span class="p">)</span>
</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../index.html">polyphys</a></h1>








<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api.html">API</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../modules/polyphys.analyze.html">polyphys.analyze</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../modules/polyphys.construct.html">polyphys.construct</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../modules/polyphys.manage.html">polyphys.manage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../modules/polyphys.probe.html">polyphys.probe</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../modules/polyphys.visualize.html">polyphys.visualize</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  <li><a href="../../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022, Amir Sadeghi.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.3.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
    </div>

    

    
  </body>
</html>