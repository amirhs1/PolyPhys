neighbor                0.2 bin
neigh_modify    delay 0 every 1 check yes 

processors 2 2 *

#read_restart    restart.1.20000000
change_box  all x final -${r} ${r} y final -${r} ${r} z final -${lz} ${lz} boundary f f p units box
region  cylshell cylinder z 0.0 0.0 ${r} INF INF units box


variable sig1 equal 1.0
variable sig2 equal ${sig2}
variable sig12 equal (${sig1}+${sig2})/2
variable sig13 equal (${sig1}+${sig3})/2
variable sig23 equal (${sig2}+${sig3})/2

variable cutoff11 equal ${sig1}*1.12246205
variable cutoff12 equal ((${sig1}+${sig2})/2.0)*1.12246205
variable cutoff22 equal ${sig2}*1.12246205
variable cutoff13 equal ((${sig1}+${sig3})/2.0)*1.12246205
variable cutoff23 equal ((${sig2}+${sig3})/2.0)*1.12246205
variable cutoff33 equal ${sig3}*1.12246205

fix     F_langevin all langevin 1.0 1.0 10.0 ${randseed}
#---------- Lennard-Jones potential between the lateral wall and each type of particles ----------
fix     F_wall_small bug_small wall/region cylshell lj126 ${epsilon_small} ${sig1} ${cutoff11} # Interaction between the lateral wall and the monomers.
fix     F_wall_big bug_big wall/region cylshell lj126 ${epsilon_big} ${sig12} ${cutoff12} # Interaction between the lateral wall and the monomers.
fix     F_wall_corwd crowd wall/region cylshell lj126 1.0 ${sig13}  ${cutoff13} # Interaction between the lateral wall and the crowders.

fix             F_nve all nve
fix             F_recenter bug recenter NULL NULL 0.0 shift all units box

timestep    ${run_dt}
thermo_style multi
thermo 10000

dump     D_bug bug atom  ${bug_dump} bug.i${i}.lammpstrj
dump_modify D_bug scale no

variable fname string input.lmp
variable j loop ${nloop} pad
    label dump_loop
    dump         D_all all atom  5000 bug.i${i}.j${j}.restart.lammpstrj.gz
    dump_modify D_all scale no pad 2
    restart 1000000  ./restart.new.i${i}
    if "$j == ${nloop}" then "run 8000000" else "run 5000000"
    undump D_all
    next j
    jump ${fname} dump_loop

undump D_bug
write_data all.ns${n_small}.nb${n_large}.nc${n_crowd}.data pair ij
write_restart    ./restart_after
