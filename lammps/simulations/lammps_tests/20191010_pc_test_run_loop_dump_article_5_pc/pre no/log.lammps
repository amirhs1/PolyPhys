LAMMPS (7 Aug 2019)
# Type: 3-d LJ polymer simulation
# Description: A computational study of the compaction of a linear polymeric chain by spherical crowders in a cylindrical confinement.

#------------------------------------------
#--------------------- (1) Variables defined by command-line tools ---------------------
#------------------------------------------

#List of variables and their names defined by command line method. Their description and the step they will be used in are described in next sections:
#variable ${in_filename}
#variable ${i} # i is the seed for the RNG.
#variable ${r} # the radius of the cylinder.
#variable ${lz} # the length of the cylinder in the longitudinal direction z
#variable ${sig2} # diameter of a crowder
#variable ${n_crowd} # Number of the crowders
#variable ${epsilon1} # the strength of the LJ potential of the wall built on the lateral surface of the cylinder.

#------------------------------------------
#--------------------- (2) Initialization ---------------------
#------------------------------------------
units   lj # Lennard-Jones units.
dimension   3 # 3 dimensional simulation.
boundary    f f p # Periodic (p) in z direction but non-periodic and fixed (f) in x and y directions.
atom_style  bond

#------------------------------------------
#--------------------- (3) Neighbor Lists ---------------------
#------------------------------------------

neighbor        0.2 bin
neigh_modify    delay 0 every 1 check yes one 300 page 3000

#------------------------------------------
#--------------------- (4) Processors Communications ---------------------
#------------------------------------------


#------------------------------------------
#--------------------- (5) Atom Definition ---------------------
#------------------------------------------

#---------- Read input file ----------
read_data   ${in_filename}
read_data   data.chain.80
  orthogonal box = (-4.1 -4.1 -5.03) to (4.1 4.1 5.88713)
  1 by 1 by 1 MPI processor grid
  reading atoms ...
  80 atoms
  reading velocities ...
  80 velocities
  scanning bonds ...
  1 = max bonds/atom
  reading bonds ...
  79 bonds
  2 = max # of 1-2 neighbors
  2 = max # of 1-3 neighbors
  4 = max # of 1-4 neighbors
  6 = max # of special neighbors
  special bonds CPU = 9.29832e-05 secs
  read_data CPU = 0.00323391 secs

#---------- Reshape simulation box/Define simulation box   ----------
change_box  all x final -${r} ${r} y final -${r} ${r} z final -${lz} ${lz} boundary f f p units box
change_box  all x final -3 ${r} y final -${r} ${r} z final -${lz} ${lz} boundary f f p units box
change_box  all x final -3 3 y final -${r} ${r} z final -${lz} ${lz} boundary f f p units box
change_box  all x final -3 3 y final -3 ${r} z final -${lz} ${lz} boundary f f p units box
change_box  all x final -3 3 y final -3 3 z final -${lz} ${lz} boundary f f p units box
change_box  all x final -3 3 y final -3 3 z final -52 ${lz} boundary f f p units box
change_box  all x final -3 3 y final -3 3 z final -52 52 boundary f f p units box
  orthogonal box = (-3 -4.1 -5.03) to (3 4.1 5.88713)
  orthogonal box = (-3 -3 -5.03) to (3 3 5.88713)
  orthogonal box = (-3 -3 -52) to (3 3 52)
region  cylshell cylinder z 0.0 0.0 ${r} INF INF units box
region  cylshell cylinder z 0.0 0.0 3 INF INF units box

#---------- Create atoms ----------
variable    randseed equal ${i}+1000
variable    randseed equal 1+1000
create_atoms	2 random ${n_crowd} ${randseed} cylshell units box
create_atoms	2 random 1000 ${randseed} cylshell units box
create_atoms	2 random 1000 1001 cylshell units box
Created 1000 atoms
  create_atoms CPU = 0.000671864 secs

#---------- Group atoms ----------
group   bug type 1
80 atoms in group bug
group   crowd type 2
1000 atoms in group crowd

#---------- Define atoms masses ----------
mass 1 1.0
mass 2 1.0

#---------- Set velocity of the chain ----------
#----- Define a temperature compute for the chain and use to set velocity for the chain -----
compute mobile bug temp
velocity   bug create 1.0 ${randseed} temp mobile
velocity   bug create 1.0 1001 temp mobile

#------------------------------------------
#--------------------- (6) Interatomic/molecular Potential ---------------------
#------------------------------------------

#---------- Lennard-Jones potential among all particles ----------
#---------- (6-a) Variables ----------
variable sig1 equal 1.0
variable sig12 equal (${sig1}+${sig2})/2
variable sig12 equal (1+${sig2})/2
variable sig12 equal (1+0.3)/2
variable cutoff11 equal ${sig1}*1.12246
variable cutoff11 equal 1*1.12246
variable cutoff12 equal ((${sig1}+${sig2})/2.0)*1.12246
variable cutoff12 equal ((1+${sig2})/2.0)*1.12246
variable cutoff12 equal ((1+0.3)/2.0)*1.12246
variable cutoff22 equal ${sig2}*1.12246
variable cutoff22 equal 0.3*1.12246

pair_style      lj/cut 1.12246 # Cutoff distance = 2^(1/6) = 1.12246. For each pair, this cutoff is multiplied by sig_{ij} to give the real cutoff for each pair.

#Pair coefficient:   type-i  type-j (i should always be smaller than j) epsilon=1 sigma=(a_i+a_j)/2   cutoff=((sig_i+sig_j)/2)*2^(1/6)
pair_coeff      1 1 1.0 ${sig1}  ${cutoff11}
pair_coeff      1 1 1.0 1  ${cutoff11}
pair_coeff      1 1 1.0 1  1.12246
pair_coeff      1 2 1.0 ${sig12} ${cutoff12}
pair_coeff      1 2 1.0 0.65 ${cutoff12}
pair_coeff      1 2 1.0 0.65 0.729599
pair_coeff      2 2 1.0 ${sig2}  ${cutoff22}
pair_coeff      2 2 1.0 0.3  ${cutoff22}
pair_coeff      2 2 1.0 0.3  0.336738

#---------- FENE potential among the chain's monomers ----------
#---------- (6-b) Variables ----------
variable    sig1_fene equal 1.5*${sig1}
variable    sig1_fene equal 1.5*1
variable    k1_fene equal  30/(${sig1}*${sig1})
variable    k1_fene equal  30/(1*${sig1})
variable    k1_fene equal  30/(1*1)

bond_style  fene

#Bond coefficient:  type-i  K=(30*epsilon)/((a_i+a_j_^2)   R_0=1.5*((a_i+a_j)/2 )   epsilon=1    sigma=(a_i+a_j)/2
bond_coeff  1 ${k1_fene}  ${sig1_fene}    1.0 ${sig1}
bond_coeff  1 30  ${sig1_fene}    1.0 ${sig1}
bond_coeff  1 30  1.5    1.0 ${sig1}
bond_coeff  1 30  1.5    1.0 1

#---------- Weighting coefficient for bonded atoms with pairwise interactions (Example,LJ interaction of two monomers in a chain) ----------
special_bonds   fene
  2 = max # of 1-2 neighbors
  6 = max # of special neighbors
  special bonds CPU = 0.000166893 secs


#------------------------------------------
#--------------------- (7) Settings ---------------------
#------------------------------------------

#---------- Equilibration/Method of integration of equation of motion ----------
# Microcanonical ensamble:
fix     F_nve all nve/limit 0.01

#---------- Brownian dynamics for all particles ----------
fix     F_langevin all langevin 1.0 1.0 10.0 ${randseed}
fix     F_langevin all langevin 1.0 1.0 10.0 1001

#---------- Lennard-Jones potential between the lateral wall and each type of particles ----------
fix     F_wall1 bug wall/region cylshell lj126 ${epsilon1} ${sig1} ${cutoff11} # Interaction between the lateral wall and the monomers.
fix     F_wall1 bug wall/region cylshell lj126 5.0 ${sig1} ${cutoff11} 
fix     F_wall1 bug wall/region cylshell lj126 5.0 1 ${cutoff11} 
fix     F_wall1 bug wall/region cylshell lj126 5.0 1 1.12246 
fix     F_wall2 crowd wall/region cylshell lj126 1.0 ${sig12}  ${cutoff12} # Interaction between the lateral wall and the crowders.
fix     F_wall2 crowd wall/region cylshell lj126 1.0 0.65  ${cutoff12} 
fix     F_wall2 crowd wall/region cylshell lj126 1.0 0.65  0.729599 

fix     F_recenter bug recenter NULL NULL 0.0 shift all units box


#------------------------------------------
#--------------------- (8) Run a simulation ---------------------
#------------------------------------------

#---------- Equilibration run (Dynamic phase)
timestep 0.01

thermo 10000
#dump	 D_all_dynamic all custom 1000 all.dynamic.${i}.lammpstrj id type x y z xs ys zs
#dump D_bug_image bug image 5000 ./images/img_*_bug.jpg type type axes yes 0.3 0.05
#dump D_all_image all image 5000 ./images/img_*_all.jpg type type axes yes 0.3 0.05
#dump_modify D_bug_image first yes pad 8
#dump_modify D_all_image first yes pad 8
run 10000
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 300, page size: 3000
  master list distance cutoff = 1.32246
  ghost atom cutoff = 1.32246
  binsize = 0.66123, bins = 10 10 158
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut, perpetual
      attributes: half, newton on
      pair build: half/bin/newton
      stencil: half/bin/3d/newton
      bin: standard
WARNING: Communication cutoff 1.32246 is shorter than a bond length based estimate of 1.655. This may lead to errors. (../comm.cpp:685)
Per MPI rank memory allocation (min/avg/max) = 4.144 | 4.144 | 4.144 Mbytes
Step Temp E_pair E_mol TotEng Press 
       0  0.073215941    10199.665    1969.4123    12169.187    14062.029 
   10000   0.19013077  -0.01932436    1.4824317    1.7480394  0.042213607 
Loop time of 1.10082 on 1 procs for 10000 steps with 1080 atoms

Performance: 7848672.051 tau/day, 9084.111 timesteps/s
99.6% CPU use with 1 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.062232   | 0.062232   | 0.062232   |   0.0 |  5.65
Bond    | 0.018022   | 0.018022   | 0.018022   |   0.0 |  1.64
Neigh   | 0.24741    | 0.24741    | 0.24741    |   0.0 | 22.48
Comm    | 0.013733   | 0.013733   | 0.013733   |   0.0 |  1.25
Output  | 2.4796e-05 | 2.4796e-05 | 2.4796e-05 |   0.0 |  0.00
Modify  | 0.721      | 0.721      | 0.721      |   0.0 | 65.50
Other   |            | 0.03839    |            |       |  3.49

Nlocal:    1080 ave 1080 max 1080 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    29 ave 29 max 29 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    244 ave 244 max 244 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 244
Ave neighs/atom = 0.225926
Ave special neighs/atom = 0.146296
Neighbor list builds = 984
Dangerous builds = 1
